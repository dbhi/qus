<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frequently Asked Questions (FAQ) &mdash; qemu-user-static (qus) and containers latest documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=c6e86fd7"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Other related sources" href="related.html" />
    <link rel="prev" title="Development" href="development.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> qemu-user-static (qus) and containers
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="context.html">Context: containers and QEMU</a></li>
<li class="toctree-l1"><a class="reference internal" href="images.html">Provided container images</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frequently Asked Questions (FAQ)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#does-qus-work-for-building-images">Does <cite>qus</cite> work for building images?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#do-i-need-to-install-qemu-static-on-the-host-even-though-it-is-only-needed-by-the-containers">Do I need to install <code class="docutils literal notranslate"><span class="pre">qemu-*-static</span></code> on the host, even though it is only needed by the containers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#if-the-container-depends-on-a-given-minimum-qemu-version-do-i-need-to-ensure-that-the-host-provides-this-version">If the container depends on a given minimum QEMU version, do I need to ensure that the host provides this version?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-can-i-use-qemu-static-binaries-without-registering-them-with-the-persistent-flag-and-without-installing-them-in-the-container-image">How can I use <code class="docutils literal notranslate"><span class="pre">qemu-*-static</span></code> binaries without registering them with the <em>persistent</em> flag and without installing them in the container image?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-can-the-scripts-in-aptman-qus-be-customized">How can the scripts in aptman/qus be customized?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="related.html">Other related sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">qemu-user-static (qus) and containers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
        
          
            <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Frequently Asked Questions (FAQ)</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/dbhi/qus/blob/main/docs/faq.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="frequently-asked-questions-faq">
<span id="qus-faq"></span><h1>Frequently Asked Questions (FAQ)<a class="headerlink" href="#frequently-asked-questions-faq" title="Link to this heading">¶</a></h1>
<section id="does-qus-work-for-building-images">
<h2>Does <cite>qus</cite> work for building images?<a class="headerlink" href="#does-qus-work-for-building-images" title="Link to this heading">¶</a></h2>
<p>Yes, once the QEMU binary is configured/loaded, both building images and running containers is supported.</p>
</section>
<section id="do-i-need-to-install-qemu-static-on-the-host-even-though-it-is-only-needed-by-the-containers">
<h2>Do I need to install <code class="docutils literal notranslate"><span class="pre">qemu-*-static</span></code> on the host, even though it is only needed by the containers?<a class="headerlink" href="#do-i-need-to-install-qemu-static-on-the-host-even-though-it-is-only-needed-by-the-containers" title="Link to this heading">¶</a></h2>
<p>You can use static binaries at any location.
So, you don’t need to install all the <code class="docutils literal notranslate"><span class="pre">qemu-*-static</span></code> on the host.
You just download the ones you want/need to a temporal folder.
See cases <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">v</span></code> or <code class="docutils literal notranslate"><span class="pre">V</span></code> in <a class="reference internal" href="tests.html#qus-tests"><span class="std std-ref">Tests</span></a>.</p>
<p>It is still a downside that any other process in the host will use these binaries.
However, the advantage is that you don’t need to copy anything in the docker images.
You can use them directly.
Furthermore, you can run multiple foreign containers with a single binary, instead of copying it to all the images.</p>
</section>
<section id="if-the-container-depends-on-a-given-minimum-qemu-version-do-i-need-to-ensure-that-the-host-provides-this-version">
<h2>If the container depends on a given minimum QEMU version, do I need to ensure that the host provides this version?<a class="headerlink" href="#if-the-container-depends-on-a-given-minimum-qemu-version-do-i-need-to-ensure-that-the-host-provides-this-version" title="Link to this heading">¶</a></h2>
<p>You can put the <code class="docutils literal notranslate"><span class="pre">qemu-*-static</span></code> binaries of the version you want in a temporary folder on the host (and only for the
foreign architectures you need).
Then, temporarily use those binaries system-wide, as commented above.
When you are done, just reset the registered formats.
See <code class="docutils literal notranslate"><span class="pre">QEMU_BIN_DIR</span></code> in the register script.</p>
</section>
<section id="how-can-i-use-qemu-static-binaries-without-registering-them-with-the-persistent-flag-and-without-installing-them-in-the-container-image">
<h2>How can I use <code class="docutils literal notranslate"><span class="pre">qemu-*-static</span></code> binaries without registering them with the <em>persistent</em> flag and without installing them in the container image?<a class="headerlink" href="#how-can-i-use-qemu-static-binaries-without-registering-them-with-the-persistent-flag-and-without-installing-them-in-the-container-image" title="Link to this heading">¶</a></h2>
<p>If you don’t use <code class="docutils literal notranslate"><span class="pre">-p</span></code>, you can still share the binary/ies from the host with the containers.
The advantages of this approach are that you can use a single binary for multiple containers, you can use the version of
qemu that you want, and other processes on the host can use different versions of QEMU.
The downside is that we don’t know how to make it work with <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">build</span></code> yet.
See cases <code class="docutils literal notranslate"><span class="pre">v</span></code> or <code class="docutils literal notranslate"><span class="pre">V</span></code> in ref:<cite>qus:tests</cite>.</p>
<p>Moreover, the <code class="docutils literal notranslate"><span class="pre">qemu-*-static</span></code> binaries can be saved in a docker volume.
This allows to avoid saving them on the host and to run multiple containers with <code class="docutils literal notranslate"><span class="pre">--volumes-from</span></code>.</p>
</section>
<section id="how-can-the-scripts-in-aptman-qus-be-customized">
<h2>How can the scripts in aptman/qus be customized?<a class="headerlink" href="#how-can-the-scripts-in-aptman-qus-be-customized" title="Link to this heading">¶</a></h2>
<p>For testing purposes, it is possible to customize scripts <code class="docutils literal notranslate"><span class="pre">register.sh</span></code> or <code class="docutils literal notranslate"><span class="pre">qemu-binfmt-conf.sh</span></code>, which are the
default entrypoint in image aptman/qus.
In order to do so, get a copy of any or both of them, and modify them locally.
Then:</p>
<ul>
<li><p>Test that you can overwrite the copy inside the container with it:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>--privileged<span class="w"> </span>-itv<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/qemu-binfmt-conf.sh:/qus/qemu-binfmt-conf.sh<span class="w"> </span>--entrypoint<span class="o">=</span>sh<span class="w"> </span>aptman/qus
<span class="c1"># cat /qus/qemu-binfmt-conf.sh</span>
</pre></div>
</div>
</li>
<li><p>If successful, use it to run <em>regular</em> commands:</p></li>
</ul>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>--privileged<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/qemu-binfmt-conf.sh:/qus/qemu-binfmt-conf.sh<span class="w"> </span>aptman/qus<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>-p
</pre></div>
</div>
</div></blockquote>
<p>For instance, this is used in <a class="reference external" href="https://github.com/dbhi/qus/issues/4">#4</a>, to work around an upstream bug that prevents 32-bit ARM
interpreters from being registered on 64-bit only ARM hosts.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="development.html" class="btn btn-neutral float-left" title="Development" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="related.html" class="btn btn-neutral float-right" title="Other related sources" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Unai Martinez-Corral.</p>
  </div>Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/buildthedocs/sphinx.theme">theme</a>
    provided by <a href="https://buildthedocs.github.io">Build the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>